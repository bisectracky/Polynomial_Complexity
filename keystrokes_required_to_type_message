You may think that it is equal to the number of characters in the text, but this is correct only if each keystroke generates only one character. With pocketsize devices, the possibilities for typing text are often limited. Some devices provide only a few buttons, significantly fewer than the number of letters in the alphabet. For such devices, several strokes may be needed to type a single character.
One mechanism to deal with these limitations is a virtual keyboard displayed on a screen, with a cursor that can be moved from key to key to select characters. Four arrow buttons control the movement of the cursor, and when the cursor is positioned over an appropriate key, pressing the fifth button selects the corresponding character and appends it to the end of the text. To terminate the text, the user must navigate to and select the Enter key. This provides users with an arbitrary set of characters and enables them to type text of any length with only five hardware buttons.
In this problem, you are given a virtual keyboard layout in a two dimensional array A with r rows and c columns. Your task is to determine the minimal number of strokes needed to type a given text, where pressing any of the five hardware buttons constitutes a stroke. Note that you stroke OK key in the middle to type the letter which should be counted. The keys are arranged in a rectangular grid, such that each virtual key occupies one or more connected unit squares of the grid. The cursor starts in the upper left corner of the keyboard and moves in the four cardinal directions, in such a way that it always skips to the next unit square in that direction that belongs to a different key. If there is no such unit square, the cursor does not move.
Figure 1, shows an example for a virtual keyboard. For such an input, we are given an array of size 7 × 5. It shows a possible way to type ALGORITHM using 32 strokes. Note that there is only one key corresponding to any given character. Each key is made up of one or more grid squares, which will always form a connected region. The character key ‘\n’ represents Enter in the virtual keyboard. The input is A and s where A is an array of size r×c as a virtual keyboard and s is a string of size n as an input text to be typed.


(a) Write a pseudocode for an algorithm that finds the minimal number of strokes necessary to type the whole text, including the Enter key at the end of typing. It is guaranteed that the text can be typed.

(b) Analyze the running time of your algorithm.
